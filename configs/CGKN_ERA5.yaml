experiment:
  save_dir: ./results/cgkn_era5
  seed: 42
  device: cuda

data:
  data_path: data/ERA5/ERA5_data/train_seq_state.h5
  seq_length: 12
  num_workers: 4
  train_split: 0.8
  batch_size: 8

sensors:
  K: 200
  strategy: random
  custom_coords: []
  normalize_xy: true

model:
  dv: 128
  dc: 256
  ae:
    encoder: cnn
    decoder: cnn
    channels: [32, 64, 128]
    act: silu
    dropout: 0.0
  dynamics:
    g2_param: lowrank_banded
    g2_rank: 8
    g2_bandwidth: 0
    init_scale: 1.0e-3

noise:
  sigma2: 1.0e-3
  sigma1_estimate: true
  sigma1_min: 1.0e-6
  sigma1_max: 1.0

train:
  dt: 1.0
  optimizer: adam
  lr: 1.0e-3
  weight_decay: 0.0
  epochs_stage1: 20
  epochs_stage2: 50
  grad_clip: 1.0
  log_interval: 50

windows:
  short_forecast: 20
  long_da: 300
  warmup: 10

loss:
  lambda_AE: auto
  lambda_U: auto
  lambda_V: auto
  lambda_DA: auto

eval:
  save_ckpt: true
  ckpt_stage1: stage1.pt
  ckpt_stage2: stage2.pt
  dump_samples: 4
