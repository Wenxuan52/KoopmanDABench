Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [2/15]
Train - Total: 0.0137, Forward: 0.0094, ID: 0.0086
Val   - Total: 0.0206, Forward: 0.0179, ID: 0.0053
[INFO] New best validation loss: 0.0206 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:59<00:00,  2.53it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [3/15]
Train - Total: 0.0089, Forward: 0.0062, ID: 0.0054
Val   - Total: 0.0193, Forward: 0.0178, ID: 0.0030
[INFO] New best validation loss: 0.0193 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [4/15]
Train - Total: 0.0079, Forward: 0.0055, ID: 0.0049
Val   - Total: 0.0172, Forward: 0.0159, ID: 0.0026
[INFO] New best validation loss: 0.0172 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.55it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [5/15]
Train - Total: 0.0068, Forward: 0.0048, ID: 0.0040
Val   - Total: 0.0221, Forward: 0.0204, ID: 0.0035

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.57it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [6/15]
Train - Total: 0.0045, Forward: 0.0032, ID: 0.0025
Val   - Total: 0.0193, Forward: 0.0185, ID: 0.0018

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [7/15]
Train - Total: 0.0022, Forward: 0.0017, ID: 0.0011
Val   - Total: 0.0186, Forward: 0.0182, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [8/15]
Train - Total: 0.0034, Forward: 0.0025, ID: 0.0019
Val   - Total: 0.0203, Forward: 0.0193, ID: 0.0018

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.55it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [9/15]
Train - Total: 0.0030, Forward: 0.0022, ID: 0.0016
Val   - Total: 0.0182, Forward: 0.0176, ID: 0.0013
[INFO] Early stopping triggered after 5 epochs without improvement
[INFO] Training completed. Best validation loss: 0.0172

[INFO] Training forward model stage 2
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.0008
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:59<00:00,  2.53it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [1/15]
Train - Total: 0.0054, Forward: 0.0039, ID: 0.0031
Val   - Total: 0.0165, Forward: 0.0157, ID: 0.0016
[INFO] New best validation loss: 0.0165 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800::  59%|████████████████████████████████▉                       | 178/303 [01:10<00:47,  2.61it/s]Training Epochs with lr=0.000800::  59%|████████████████████████████████▉                       | 178/303 [01:10<00:49,  2.51it/s]
Traceback (most recent call last):
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 584, in <module>
    del dynamics_dataset, single_step_dataset
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 557, in main
    print(f"\n[INFO] Training forward model stage {i+1}")
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 453, in train_forward_model
    loss.backward()
  File "/root/miniconda3/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/root/miniconda3/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

(base) root@autodl-container-6ea349ac34-39f0109b:~/autodl-tmp/irp-test-framework/src/models/DMD# python cylinder_trainer.py
[INFO] Using cuda:0 device
[INFO] _CudaDeviceProperties(name='NVIDIA GeForce RTX 4090', major=8, minor=9, total_memory=24111MB, multi_processor_count=128)
[INFO] Starting Cylinder Flow Model Training
[INFO] Configuration: {'seq_length': 12, 'history_len': 10, 'num_epochs': 60, 'decay_step': 15, 'batch_size': 128, 'learning_rate': 0.001, 'decay_rate': 0.8, 'lamb': 0.5, 'nu': 0.1, 'subsample_ratio': 1.0}

==================================================
TRAINING FORWARD MODEL
==================================================
[INFO] Loaded Cylinder data with shape: (49, 1000, 2, 64, 64)
[INFO] Created 38729 training sequences
[INFO] Created 9683 validation sequences
[INFO] Subsampling ratio: 1.0
[INFO] Normalization computed from 1000 samples
[INFO] Mean shape: (2, 1, 1), Std shape: (2, 1, 1)
[INFO] Mean: [2.59905661 2.52492941], Std: [1.6983963  1.73951091]

[INFO] Training forward model stage 1
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.001
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Traceback (most recent call last):
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 587, in <module>
    main()
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 560, in main
    loss_info = train_forward_model(forward_model, 
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 470, in train_forward_model
    val_loss_epoch, val_fwd_loss_epoch, val_id_loss_epoch = evaluate_forward_model(
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 351, in evaluate_forward_model
    val_dataloader = DataLoader(val_dataset, batch_size=bs, shuffle=False)
NameError: name 'bs' is not defined. Did you mean: 'os'?
(base) root@autodl-container-6ea349ac34-39f0109b:~/autodl-tmp/irp-test-framework/src/models/DMD# python cylinder_trainer.py
[INFO] Using cuda:0 device
[INFO] _CudaDeviceProperties(name='NVIDIA GeForce RTX 4090', major=8, minor=9, total_memory=24111MB, multi_processor_count=128)
[INFO] Starting Cylinder Flow Model Training
[INFO] Configuration: {'seq_length': 12, 'history_len': 10, 'num_epochs': 60, 'decay_step': 15, 'batch_size': 128, 'learning_rate': 0.001, 'decay_rate': 0.8, 'lamb': 0.5, 'nu': 0.1, 'subsample_ratio': 1.0}

==================================================
TRAINING FORWARD MODEL
==================================================
[INFO] Loaded Cylinder data with shape: (49, 1000, 2, 64, 64)
[INFO] Created 38729 training sequences
[INFO] Created 9683 validation sequences
[INFO] Subsampling ratio: 1.0
[INFO] Normalization computed from 1000 samples
[INFO] Mean shape: (2, 1, 1), Std shape: (2, 1, 1)
[INFO] Mean: [2.59905661 2.52492941], Std: [1.6983963  1.73951091]

[INFO] Training forward model stage 1
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.001
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Traceback (most recent call last):
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 587, in <module>
    main()
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 560, in main
    loss_info = train_forward_model(forward_model, 
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 470, in train_forward_model
    val_loss_epoch, val_fwd_loss_epoch, val_id_loss_epoch = evaluate_forward_model(
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 372, in evaluate_forward_model
    total_loss += (loss_fwd + lamb * loss_id).item()  # Using same lamb=0.3
NameError: name 'lamb' is not defined
(base) root@autodl-container-6ea349ac34-39f0109b:~/autodl-tmp/irp-test-framework/src/models/DMD# python cylinder_trainer.py
[INFO] Using cuda:0 device
[INFO] _CudaDeviceProperties(name='NVIDIA GeForce RTX 4090', major=8, minor=9, total_memory=24111MB, multi_processor_count=128)
[INFO] Starting Cylinder Flow Model Training
[INFO] Configuration: {'seq_length': 12, 'history_len': 10, 'num_epochs': 60, 'decay_step': 15, 'batch_size': 128, 'learning_rate': 0.001, 'decay_rate': 0.8, 'lamb': 0.5, 'nu': 0.1, 'subsample_ratio': 1.0}

==================================================
TRAINING FORWARD MODEL
==================================================
[INFO] Loaded Cylinder data with shape: (49, 1000, 2, 64, 64)
[INFO] Created 38729 training sequences
[INFO] Created 9683 validation sequences
[INFO] Subsampling ratio: 1.0
[INFO] Normalization computed from 1000 samples
[INFO] Mean shape: (2, 1, 1), Std shape: (2, 1, 1)
[INFO] Mean: [2.59905661 2.52492941], Std: [1.6983963  1.73951091]

[INFO] Training forward model stage 1
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.001
Traceback (most recent call last):
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 584, in <module>
    main()
  File "/root/autodl-tmp/irp-test-framework/src/models/DMD/cylinder_trainer.py", line 564, in main
    lamb=lamb)
NameError: name 'lamb' is not defined
(base) root@autodl-container-6ea349ac34-39f0109b:~/autodl-tmp/irp-test-framework/src/models/DMD# python cylinder_trainer.py
[INFO] Using cuda:0 device
[INFO] _CudaDeviceProperties(name='NVIDIA GeForce RTX 4090', major=8, minor=9, total_memory=24111MB, multi_processor_count=128)
[INFO] Starting Cylinder Flow Model Training
[INFO] Configuration: {'seq_length': 12, 'history_len': 10, 'num_epochs': 60, 'decay_step': 15, 'batch_size': 128, 'learning_rate': 0.001, 'decay_rate': 0.8, 'lamb': 0.5, 'nu': 0.1, 'subsample_ratio': 1.0}

==================================================
TRAINING FORWARD MODEL
==================================================
[INFO] Loaded Cylinder data with shape: (49, 1000, 2, 64, 64)
[INFO] Created 38729 training sequences
[INFO] Created 9683 validation sequences
[INFO] Subsampling ratio: 1.0
[INFO] Normalization computed from 1000 samples
[INFO] Mean shape: (2, 1, 1), Std shape: (2, 1, 1)
[INFO] Mean: [2.59905661 2.52492941], Std: [1.6983963  1.73951091]

[INFO] Training forward model stage 1
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.001
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.57it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [1/15]
Train - Total: 0.6551, Forward: 0.4371, ID: 0.4360
Val   - Total: 0.0608, Forward: 0.0412, ID: 0.0392
[INFO] New best validation loss: 0.0608 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.57it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [2/15]
Train - Total: 0.0425, Forward: 0.0284, ID: 0.0281
Val   - Total: 0.0295, Forward: 0.0205, ID: 0.0180
[INFO] New best validation loss: 0.0295 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [3/15]
Train - Total: 0.0231, Forward: 0.0155, ID: 0.0153
Val   - Total: 0.0224, Forward: 0.0154, ID: 0.0141
[INFO] New best validation loss: 0.0224 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [4/15]
Train - Total: 0.0177, Forward: 0.0119, ID: 0.0116
Val   - Total: 0.0165, Forward: 0.0119, ID: 0.0092
[INFO] New best validation loss: 0.0165 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.60it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [5/15]
Train - Total: 0.0131, Forward: 0.0088, ID: 0.0086
Val   - Total: 0.0149, Forward: 0.0116, ID: 0.0067
[INFO] New best validation loss: 0.0149 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [6/15]
Train - Total: 0.0113, Forward: 0.0076, ID: 0.0074
Val   - Total: 0.0203, Forward: 0.0136, ID: 0.0133

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [7/15]
Train - Total: 0.0104, Forward: 0.0070, ID: 0.0067
Val   - Total: 0.0088, Forward: 0.0060, ID: 0.0055
[INFO] New best validation loss: 0.0088 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.56it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [8/15]
Train - Total: 0.0097, Forward: 0.0066, ID: 0.0063
Val   - Total: 0.0073, Forward: 0.0051, ID: 0.0043
[INFO] New best validation loss: 0.0073 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:59<00:00,  2.54it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [9/15]
Train - Total: 0.0074, Forward: 0.0051, ID: 0.0047
Val   - Total: 0.0069, Forward: 0.0048, ID: 0.0040
[INFO] New best validation loss: 0.0069 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [10/15]
Train - Total: 0.0072, Forward: 0.0049, ID: 0.0046
Val   - Total: 0.0050, Forward: 0.0035, ID: 0.0029
[INFO] New best validation loss: 0.0050 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [11/15]
Train - Total: 0.0070, Forward: 0.0047, ID: 0.0044
Val   - Total: 0.0144, Forward: 0.0098, ID: 0.0092

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:53<00:00,  2.67it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [12/15]
Train - Total: 0.0065, Forward: 0.0044, ID: 0.0041
Val   - Total: 0.0059, Forward: 0.0041, ID: 0.0035

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [13/15]
Train - Total: 0.0057, Forward: 0.0039, ID: 0.0036
Val   - Total: 0.0070, Forward: 0.0049, ID: 0.0041

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0057, Forward: 0.0039, ID: 0.0036
Val   - Total: 0.0039, Forward: 0.0028, ID: 0.0022
[INFO] New best validation loss: 0.0039 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.001000:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [15/15]
Train - Total: 0.0052, Forward: 0.0036, ID: 0.0033
Val   - Total: 0.0054, Forward: 0.0038, ID: 0.0033

[INFO] Training completed. Best validation loss: 0.0039

[INFO] Training forward model stage 2
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.0008
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [1/15]
Train - Total: 0.0068, Forward: 0.0046, ID: 0.0043
Val   - Total: 0.0050, Forward: 0.0035, ID: 0.0031
[INFO] New best validation loss: 0.0050 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [2/15]
Train - Total: 0.0036, Forward: 0.0025, ID: 0.0022
Val   - Total: 0.0058, Forward: 0.0040, ID: 0.0036

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [3/15]
Train - Total: 0.0031, Forward: 0.0021, ID: 0.0019
Val   - Total: 0.0036, Forward: 0.0025, ID: 0.0021
[INFO] New best validation loss: 0.0036 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [4/15]
Train - Total: 0.0041, Forward: 0.0028, ID: 0.0026
Val   - Total: 0.0023, Forward: 0.0017, ID: 0.0012
[INFO] New best validation loss: 0.0023 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.60it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [5/15]
Train - Total: 0.0035, Forward: 0.0024, ID: 0.0022
Val   - Total: 0.0043, Forward: 0.0030, ID: 0.0027

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.61it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [6/15]
Train - Total: 0.0025, Forward: 0.0017, ID: 0.0015
Val   - Total: 0.0128, Forward: 0.0086, ID: 0.0084

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.61it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [7/15]
Train - Total: 0.0039, Forward: 0.0027, ID: 0.0024
Val   - Total: 0.0019, Forward: 0.0014, ID: 0.0011
[INFO] New best validation loss: 0.0019 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [8/15]
Train - Total: 0.0032, Forward: 0.0022, ID: 0.0020
Val   - Total: 0.0043, Forward: 0.0029, ID: 0.0027

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.61it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [9/15]
Train - Total: 0.0034, Forward: 0.0023, ID: 0.0021
Val   - Total: 0.0026, Forward: 0.0018, ID: 0.0016

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [10/15]
Train - Total: 0.0018, Forward: 0.0013, ID: 0.0011
Val   - Total: 0.0017, Forward: 0.0012, ID: 0.0010
[INFO] New best validation loss: 0.0017 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [11/15]
Train - Total: 0.0022, Forward: 0.0015, ID: 0.0013
Val   - Total: 0.0065, Forward: 0.0045, ID: 0.0041

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.60it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [12/15]
Train - Total: 0.0029, Forward: 0.0020, ID: 0.0018
Val   - Total: 0.0016, Forward: 0.0011, ID: 0.0009
[INFO] New best validation loss: 0.0016 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [13/15]
Train - Total: 0.0055, Forward: 0.0037, ID: 0.0035
Val   - Total: 0.0028, Forward: 0.0021, ID: 0.0015

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0027, Forward: 0.0018, ID: 0.0016
Val   - Total: 0.0018, Forward: 0.0013, ID: 0.0010

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000800:: 100%|████████████████████████████████████████████████████████| 303/303 [01:53<00:00,  2.66it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [15/15]
Train - Total: 0.0032, Forward: 0.0022, ID: 0.0020
Val   - Total: 0.0032, Forward: 0.0022, ID: 0.0019

[INFO] Training completed. Best validation loss: 0.0016

[INFO] Training forward model stage 3
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.0006400000000000002
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [1/15]
Train - Total: 0.0041, Forward: 0.0028, ID: 0.0026
Val   - Total: 0.0014, Forward: 0.0010, ID: 0.0008
[INFO] New best validation loss: 0.0014 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [2/15]
Train - Total: 0.0018, Forward: 0.0012, ID: 0.0010
Val   - Total: 0.0019, Forward: 0.0014, ID: 0.0011

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:53<00:00,  2.68it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [3/15]
Train - Total: 0.0038, Forward: 0.0026, ID: 0.0023
Val   - Total: 0.0080, Forward: 0.0055, ID: 0.0051

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:52<00:00,  2.70it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [4/15]
Train - Total: 0.0018, Forward: 0.0013, ID: 0.0011
Val   - Total: 0.0013, Forward: 0.0009, ID: 0.0007
[INFO] New best validation loss: 0.0013 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:50<00:00,  2.73it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [5/15]
Train - Total: 0.0019, Forward: 0.0014, ID: 0.0011
Val   - Total: 0.0027, Forward: 0.0018, ID: 0.0017

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [6/15]
Train - Total: 0.0016, Forward: 0.0012, ID: 0.0009
Val   - Total: 0.0018, Forward: 0.0013, ID: 0.0011

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [7/15]
Train - Total: 0.0026, Forward: 0.0018, ID: 0.0016
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007
[INFO] New best validation loss: 0.0012 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [8/15]
Train - Total: 0.0011, Forward: 0.0008, ID: 0.0006
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [9/15]
Train - Total: 0.0019, Forward: 0.0013, ID: 0.0011
Val   - Total: 0.0019, Forward: 0.0013, ID: 0.0011

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:53<00:00,  2.66it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [10/15]
Train - Total: 0.0014, Forward: 0.0010, ID: 0.0008
Val   - Total: 0.0011, Forward: 0.0008, ID: 0.0006
[INFO] New best validation loss: 0.0011 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.65it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [11/15]
Train - Total: 0.0014, Forward: 0.0010, ID: 0.0008
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:59<00:00,  2.54it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [12/15]
Train - Total: 0.0028, Forward: 0.0019, ID: 0.0017
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [13/15]
Train - Total: 0.0011, Forward: 0.0008, ID: 0.0006
Val   - Total: 0.0010, Forward: 0.0007, ID: 0.0005
[INFO] New best validation loss: 0.0010 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.56it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0020, Forward: 0.0014, ID: 0.0012
Val   - Total: 0.0010, Forward: 0.0008, ID: 0.0006

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:59<00:00,  2.54it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [12/15]
Train - Total: 0.0028, Forward: 0.0019, ID: 0.0017
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [13/15]
Train - Total: 0.0011, Forward: 0.0008, ID: 0.0006
Val   - Total: 0.0010, Forward: 0.0007, ID: 0.0005
[INFO] New best validation loss: 0.0010 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.56it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0020, Forward: 0.0014, ID: 0.0012
Val   - Total: 0.0010, Forward: 0.0008, ID: 0.0006

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.56it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0020, Forward: 0.0014, ID: 0.0012
Val   - Total: 0.0010, Forward: 0.0008, ID: 0.0006

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000640:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.61it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [15/15]
Train - Total: 0.0014, Forward: 0.0010, ID: 0.0008
Val   - Total: 0.0014, Forward: 0.0010, ID: 0.0008

[INFO] Training completed. Best validation loss: 0.0010

[INFO] Training forward model stage 4
[INFO] Epochs: 15, Batch size: 128, Learning rate: 0.0005120000000000001
[INFO] Training forward model for 15 epochs
[INFO] DA Dataset split set to: train (38729 samples)
[INFO] Number of parameters: 5004868
[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512::   0%|                                                                  | 0/303 [00:00<?, ?it/s][DEBUG] pre_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] post_sequences shape: torch.Size([128, 12, 2, 64, 64])
[DEBUG] Expected format: [batch_size, seq_length, channels, height, width]
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [1/15]
Train - Total: 0.0021, Forward: 0.0014, ID: 0.0012
Val   - Total: 0.0010, Forward: 0.0007, ID: 0.0005
[INFO] New best validation loss: 0.0010 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.57it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [2/15]
Train - Total: 0.0014, Forward: 0.0010, ID: 0.0008
Val   - Total: 0.0009, Forward: 0.0007, ID: 0.0005
[INFO] New best validation loss: 0.0009 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [3/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0005
Val   - Total: 0.0013, Forward: 0.0009, ID: 0.0008

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.57it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [4/15]
Train - Total: 0.0012, Forward: 0.0009, ID: 0.0007
Val   - Total: 0.0009, Forward: 0.0007, ID: 0.0005
[INFO] New best validation loss: 0.0009 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [5/15]
Train - Total: 0.0013, Forward: 0.0009, ID: 0.0007
Val   - Total: 0.0010, Forward: 0.0007, ID: 0.0006

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.62it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [6/15]
Train - Total: 0.0010, Forward: 0.0008, ID: 0.0006
Val   - Total: 0.0008, Forward: 0.0006, ID: 0.0004
[INFO] New best validation loss: 0.0008 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [7/15]
Train - Total: 0.0014, Forward: 0.0010, ID: 0.0008
Val   - Total: 0.0008, Forward: 0.0006, ID: 0.0004
[INFO] New best validation loss: 0.0008 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [8/15]
Train - Total: 0.0009, Forward: 0.0007, ID: 0.0005
Val   - Total: 0.0019, Forward: 0.0013, ID: 0.0011

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.55it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [9/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0005
Val   - Total: 0.0008, Forward: 0.0006, ID: 0.0004

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|████████████████████████████████████████████████████████| 303/303 [01:56<00:00,  2.59it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [10/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0006
Val   - Total: 0.0009, Forward: 0.0006, ID: 0.0005

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|█████████████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [11/15]
Train - Total: 0.0020, Forward: 0.0014, ID: 0.0012
Val   - Total: 0.0016, Forward: 0.0011, ID: 0.0010

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|█████████████████████████████████████████████████████████████████| 303/303 [01:55<00:00,  2.63it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [12/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0005
Val   - Total: 0.0008, Forward: 0.0006, ID: 0.0004
[INFO] New best validation loss: 0.0008 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|█████████████████████████████████████████████████████████████████| 303/303 [01:54<00:00,  2.64it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [13/15]
Train - Total: 0.0008, Forward: 0.0006, ID: 0.0005
Val   - Total: 0.0009, Forward: 0.0007, ID: 0.0005

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|█████████████████████████████████████████████████████████████████| 303/303 [01:57<00:00,  2.58it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [14/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0005
Val   - Total: 0.0012, Forward: 0.0009, ID: 0.0007

[INFO] DA Dataset split set to: train (38729 samples)
Training Epochs with lr=0.000512:: 100%|█████████████████████████████████████████████████████████████████| 303/303 [01:58<00:00,  2.55it/s]
[INFO] DA Dataset split set to: val (9683 samples)
Epoch [15/15]
Train - Total: 0.0010, Forward: 0.0007, ID: 0.0006
Val   - Total: 0.0008, Forward: 0.0006, ID: 0.0004
[INFO] New best validation loss: 0.0008 - Saving model
[INFO] Saving forward_model weights to: model_weights/forward_model.pt
[INFO] Saving C_forward weights to: model_weights/C_forward.pt

[INFO] Training completed. Best validation loss: 0.0008
[INFO] Loaded Cylinder data with shape: (49, 1000, 2, 64, 64)
[INFO] Created 392 training sequences
[INFO] Created 98 validation sequences
[INFO] Subsampling ratio: 0.01
[INFO] Normalization computed from 392 samples
[INFO] Mean shape: (2, 1, 1), Std shape: (2, 1, 1)
[INFO] Mean: [2.56879935 2.49909043], Std: [1.67847049 1.71734608]
[INFO] save z_b to:  model_weights/z_b.pt